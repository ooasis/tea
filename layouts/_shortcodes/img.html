{{/* layouts/_shortcodes/img.html */}}
{{ $src := (.Get "src") }}
{{ $original := .Page.Resources.GetMatch $src }}
{{ if and (not $original) .Page.Parent }}
  {{ $original = .Page.Parent.Resources.GetMatch $src }}
{{ end }}
{{ if $original }}
  {{ $class := (.Get "class") | default "" }}
  {{/* Resize the image based on the "w" parameter (e.g., "500x") */}}
  {{ $resized := $original.Resize (.Get "w") }}
  <img src="{{ $resized.RelPermalink }}" 
       width="{{ $resized.Width }}" 
       height="{{ $resized.Height }}" 
       alt="{{ .Get "alt" }}"
       {{- if $class -}}class="{{ $class }}"{{- end -}}>
{{ else }}
  <p style="color:red">Image not found: {{ $src }}</p>
{{ end }}